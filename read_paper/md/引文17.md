### 定义四：
**定义 4**：分布 \( p \) 的直方图是一个映射 \( h : (0, 1] \to \mathbb{N} \cup \{0\} \)，其中 \( h(x) = |\{i : p(i) = x\}| \)。此外，我们还允许广义直方图，它们不一定取整数值。

### 解释：
这个定义描述了如何从一个离散分布中构造一个直方图，具体来说，它解释了每个不同概率值出现的次数。

#### 1. **直方图的定义**：
直方图 \( h \) 是一个从区间 \( (0, 1] \) 到非负整数集合 \( \mathbb{N} \cup \{0\} \) 的映射。这里的 \( (0, 1] \) 表示分布中所有非零的概率值（即每个元素的概率在 0 和 1 之间）。

- \( h(x) \) 表示概率值为 \( x \) 的元素个数，简单来说，就是统计在分布中概率等于 \( x \) 的元素有多少个。
- \( p(i) = x \) 表示分布 \( p \) 中第 \( i \) 个元素的概率为 \( x \)，而 \( |\{i : p(i) = x\}| \) 就是所有概率值为 \( x \) 的元素的数量。

例如，如果分布 \( p \) 中有三个元素的概率是 0.2，那么直方图 \( h(0.2) \) 的值就是 3，表示有 3 个元素的概率是 0.2。

#### 2. **广义直方图**：
直方图不仅限于整数值，广义直方图可以接受任意实数值。即使某个概率值出现的次数是非整数的（例如由于某种模型的需要），我们也允许这种情况。

#### 3. **应用场景**：
直方图在许多统计和机器学习任务中广泛应用，尤其是在分析概率分布、估计分布特征（如熵或支持大小）时。通过查看直方图，能够得到一个分布的概览，尤其是其概率值的分布情况。例如，直方图可以帮助估计哪些概率值出现得更频繁，从而对分布的特性进行进一步的分析。

总结来说，**定义 4** 提供了一种将分布转化为直方图的方式，这对分析和估计分布的不同属性（如熵、支持大小等）是非常有用的工具。

### h(x)满足的约束：
任何对称属性显然是分布直方图的函数。由于 \( h(x) \) 表示具有概率 \( x \) 的元素的数量，因此有 \( \sum_{x : h(x) \neq 0} h(x) \) 等于分布的支持大小。概率质量在概率 \( x \) 处为 \( x \cdot h(x) \)，因此对于任何对应于分布的直方图都有 \( \sum_{x : h(x) \neq 0} x \cdot h(x) = 1 \)。

我们现在定义两个分布“接近”的含义；由于对称属性的值仅依赖于分布的直方图，我们必须在定义这个距离度量时稍加小心，以确保它在我们考虑的属性上表现良好。特别地，“接近”的分布将具有相似的熵和支持大小值。

### 解释：
这段文字介绍了对称属性与分布直方图之间的关系，并定义了分布之间的“接近”概念。

#### 1. **对称属性与直方图的关系**：
对称属性是仅依赖于分布的直方图的属性。直方图 \( h(x) \) 显示了在分布中，具有概率 \( x \) 的元素的数量。因此，任何对称属性都可以通过直方图来表达。例如，熵和支持大小等属性都可以通过直方图来计算。

- **支持大小**：支持大小指的是分布中具有非零概率的元素的数量，即 \( \sum_{x : h(x) \neq 0} h(x) \)。
- **概率质量**：在概率 \( x \) 处的概率质量是 \( x \cdot h(x) \)，因为 \( h(x) \) 表示概率为 \( x \) 的元素的数量，而这些元素的总概率是 \( x \cdot h(x) \)。对于一个有效的直方图，它的所有概率质量之和应等于 1，即 \( \sum_{x : h(x) \neq 0} x \cdot h(x) = 1 \)，这一点确保了它是一个合法的概率分布。

#### 2. **定义“接近”分布**：
在这段文字中，作者开始定义如何衡量两个分布是否“接近”。由于对称属性（如熵和支持大小）仅依赖于分布的直方图，因此我们需要仔细选择一个距离度量，使得它能够反映出两个分布在这些属性上的相似性。

- **熵和支持大小**：对于两个分布来说，如果它们在直方图上的差异较小，那么它们的熵和支持大小应该是相似的。因此，定义分布接近的标准之一就是它们的熵和支持大小非常相近。

通过这一段的介绍，我们可以看出，分布的“接近”不仅仅是直方图的相似，而是涉及到这些直方图所反映的属性，如熵和支持大小的相似性。

### 对距离的定义：
定义 5. 对于两个分布 \( p_1 \) 和 \( p_2 \)，它们各自的直方图分别为 \( h_1 \) 和 \( h_2 \)，我们定义它们之间的相对地球搬运距离（relative earthmover distance），记为 \( R(p_1, p_2) := R(h_1, h_2) \)，为在所有可能的将第一个直方图的概率质量移动到第二个直方图的方案中，最小的移动代价。每单位的移动代价是将质量从概率 \( x \) 移动到概率 \( y \) 的代价，定义为 \( | \log(x/y) | \)。

### 解释：
这一定义介绍了“地球搬运距离”（earthmover distance，简称 EMD）的一种变体，专门用于衡量两个分布的“相对”接近程度。在此，定义了两个分布 \( p_1 \) 和 \( p_2 \) 之间的 **相对地球搬运距离** \( R(p_1, p_2) \)，该距离度量基于它们的直方图（\( h_1 \) 和 \( h_2 \)）。

#### 1. **地球搬运距离**：
地球搬运距离原本是用于测量两个分布之间的差异的度量，其思想来自于“搬运土壤”的问题，假设我们有两堆土壤（直方图），需要将第一堆土壤移动到第二堆土壤的形状。搬运的成本取决于移动的土壤量和移动的“距离”。在这个问题中，搬运的“距离”是基于 **对数距离**，即 \( | \log(x/y) | \)。

#### 2. **相对地球搬运距离**：
对于两个分布 \( p_1 \) 和 \( p_2 \)，我们首先通过它们的直方图 \( h_1 \) 和 \( h_2 \) 来表示分布的情况。相对地球搬运距离的定义是通过比较将第一个直方图的概率质量移动到第二个直方图所需的最小代价来衡量分布之间的差异。移动概率质量时的成本由每个单位的概率质量从概率 \( x \) 移动到概率 \( y \) 的代价 \( | \log(x/y) | \) 决定。

#### 3. **定义细节**：
- **直方图表示**：每个直方图 \( h(x) \) 显示了在某个分布下，概率为 \( x \) 的元素的数量。
- **代价函数**：代价函数 \( | \log(x/y) | \) 指的是将概率质量从概率 \( x \) 移动到 \( y \) 所需的代价。这个对数代价函数可以量化不同概率值之间的变化的代价。
  
这种度量方法用来衡量两个分布之间在直方图上的“接近程度”，并且能对不同概率值之间的差异进行比较。

### 距离被相对地球搬运距离上界所限制：
请注意，统计距离被相对地球搬运距离上界所限制。  
指纹的分布结构与泊松分布密切相关。我们使用 \( Poi(\lambda) \) 来表示期望为 \( \lambda \) 的泊松分布，对于一个非负整数 \( j \)，定义 \( poi(\lambda, j) := \frac{\lambda^j e^{-\lambda}}{j!} \)，表示一个根据 \( Poi(\lambda) \) 分布的随机变量取值为 \( j \) 的概率。  
我们提供了两个关于上述定义的澄清示例：

### 解释：
1. **统计距离与相对地球搬运距离的关系**：
   这句话强调了相对地球搬运距离 \( R(p_1, p_2) \) 在某种程度上比统计距离更强的上界，即：
   - **统计距离** 通常是用来衡量两个分布之间的差异的，广义的统计距离包括了如 **总变差距离** 等度量。
   - **相对地球搬运距离** 则是一种特定的度量，考虑了每单位的移动代价（由对数函数给出）。因此，相对地球搬运距离提供了一个上界，可以用于控制和限制统计距离的差异。

2. **指纹分布与泊松分布的关系**：
   这里提到的“指纹分布”是指样本的统计特征（例如出现的频次）。这些统计特征与**泊松分布**密切相关，因为泊松分布常用于描述稀疏事件或随机事件发生的次数。泊松分布的期望值为 \( \lambda \)，并且它在处理如元素频率等问题时广泛应用。

3. **泊松分布**：
   - **泊松分布** \( Poi(\lambda) \) 是描述在给定的单位时间或单位区域内某事件发生次数的概率分布，其期望值（即平均发生次数）为 \( \lambda \)。
   - 对于一个非负整数 \( j \)，泊松分布的概率质量函数（PMF） \( poi(\lambda, j) \) 给出了一个泊松分布的随机变量取值为 \( j \) 的概率，其计算公式为：
     \[
     poi(\lambda, j) := \frac{\lambda^j e^{-\lambda}}{j!}
     \]
     这表示，在期望为 \( \lambda \) 的泊松分布下，事件发生 \( j \) 次的概率。

4. **两个澄清示例**：
   接下来的部分提到会通过两个示例来进一步澄清上述定义，可能是为了帮助读者更好地理解统计距离、相对地球搬运距离、以及泊松分布在这些定义中的作用。

### 总结：
- 相对地球搬运距离提供了一个上界来限制统计距离的大小，确保度量在实际应用中是可控制的。
- 指纹的分布与泊松分布相关，因为泊松分布适合描述样本中元素出现次数的分布。
- 泊松分布是一个常见的概率分布，用来描述稀疏事件的发生概率，特别是在样本频率估计中有重要应用。

### 地球搬运距离的例子一：

**示例 1**  
考虑一个来自某湖泊的鱼类物种序列，作为样本，\( X = (\text{鳟鱼, 三文鱼, 鳟鱼, 鳕鱼, 鳕鱼, 鲸鱼, 鳟鱼, 鳗鱼, 三文鱼}) \)。我们有 \( \mathcal{F}_X = (2, 2, 1) \)，表示有两种物种出现了恰好一次（鲸鱼和鳗鱼），两种物种出现了恰好两次（三文鱼和鳕鱼），一种物种出现了恰好三次（鳟鱼）。  
假设鱼类的真实分布如下：
\[
\begin{aligned}
& \Pr(\text{鳟鱼}) = \frac{1}{2}, \quad \Pr(\text{三文鱼}) = \frac{1}{4}, \\
& \Pr(\text{鳕鱼}) = \Pr(\text{鲸鱼}) = \Pr(\text{鳗鱼}) = \Pr(\text{鲨鱼}) = \frac{1}{16}.
\end{aligned}
\]
这个分布的相关直方图是 \( h: \mathbb{R}^{+} \rightarrow \mathbb{Z} \)，定义为 \( h(1/16) = 4 \)，\( h(1/4) = 1 \)，\( h(1/2) = 1 \)，并且对于所有 \( x \notin \{1/16, 1/4, 1/2\} \)，有 \( h(x) = 0 \)。

如果我们现在考虑一个在 \( \{a, b, c\} \) 上的第二个分布，其概率为 \( \Pr(a) = 1/2 \)，\( \Pr(b) = 1/4 \)，\( \Pr(c) = 1/4 \)，并且令 \( h' \) 为其相关的直方图，则相对地球搬运距离 \( R(h, h') = \frac{1}{4} \left| \log \frac{1/4}{1/16} \right| \)，因为我们必须将所有位于概率 \( 1/16 \) 处的质量移动到概率 \( 1/4 \) 处，以便将第一个分布转换为一个具有与 \( h' \) 相同直方图的分布。

### 解释：

1. **样本 \( X \)**：  
   这个示例中，样本 \( X \) 包含了9个鱼类的观察记录。样本中的物种包括鳟鱼、三文鱼、鳕鱼、鲸鱼、鳗鱼等。统计这些物种的出现频率，得到指纹 \( \mathcal{F}_X = (2, 2, 1) \)，即：
   - 有2种物种各出现了2次（三文鱼和鳕鱼），
   - 有1种物种出现了3次（鳟鱼），
   - 有2种物种各出现了1次（鲸鱼和鳗鱼）。

2. **真实分布与直方图**：
   给定的真实分布指定了各物种的概率，包括：
   - 鳟鱼的概率为 \( 1/2 \)，
   - 三文鱼的概率为 \( 1/4 \)，
   - 鳕鱼、鲸鱼、鳗鱼和鲨鱼的概率都为 \( 1/16 \)。
   
   根据这些概率，可以得到分布的直方图 \( h \)，它表示不同概率值对应的物种数量：
   - 概率为 \( 1/16 \) 的物种有4个（鳕鱼、鲸鱼、鳗鱼、鲨鱼），
   - 概率为 \( 1/4 \) 的物种有1个（三文鱼），
   - 概率为 \( 1/2 \) 的物种有1个（鳟鱼）。

3. **第二个分布与直方图 \( h' \)**：  
   第二个分布定义在 \( \{a, b, c\} \) 上，其物种的概率为：
   - \( \Pr(a) = 1/2 \)，
   - \( \Pr(b) = 1/4 \)，
   - \( \Pr(c) = 1/4 \)。
   
   对应的直方图 \( h' \) 具有3个概率值：\( 1/2 \)、\( 1/4 \) 和 \( 1/4 \)。

4. **相对地球搬运距离**：
   相对地球搬运距离 \( R(h, h') \) 是衡量两个直方图（即两个分布）之间差异的度量。为了将分布 \( h \) 转换为分布 \( h' \)，我们需要将概率为 \( 1/16 \) 的质量（对应4个物种）移动到概率为 \( 1/4 \) 的位置。根据相对地球搬运距离的定义，移动的代价是每个单位质量移动时的对数代价，即 \( |\log \frac{1/4}{1/16}| \)。

   计算得：
   \[
   R(h, h') = \frac{1}{4} \left| \log \frac{1/4}{1/16} \right| = \frac{1}{4} \left| \log 4 \right| = \frac{1}{4} \times 2 = \frac{1}{2}.
   \]

   这个值表示了将分布 \( h \) 转换为分布 \( h' \) 所需要的最小移动代价。